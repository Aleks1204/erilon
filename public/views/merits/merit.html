<!DOCTYPE html>
<html lang="en">
<head>
    <title>Достоинство</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    <link rel="stylesheet" href="/stylesheets/main.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.14/angular.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ngStorage/0.3.10/ngStorage.min.js"></script>
    <script src="/views/permissions/permissions.js"></script>
    <script src="merit.js"></script>
    <script src="/views/permissions/check_player_permissions.js"></script>
</head>
<body ng-app="meritApp">
<div ng-controller="permissionsController">
    <div data-ng-include data-src="'/views/main-menu.html'"></div>

    <div ng-controller="prerequisitesListController">
        <h2 class="text-center">{{merit.name}}</h2>

        <h3 class="text-center">Пререквизиты</h3>

        <div ng-hide="meritAttributes.length == 0">
            <h4 class="text-center">Пререквизиты-атрибуты</h4>
            <table class="table table-striped">
                <tr>
                    <th style="text-align: center">Атрибут</th>
                    <th style="text-align: center">Не меньше чем</th>
                    <th style="text-align: center"></th>
                </tr>
                <tr ng-repeat="meritAttribute in meritAttributes | orderBy : 'meritAttribute.Attribute.name'">
                    <td style="vertical-align:middle; text-align: center">{{meritAttribute.Attribute.name}}</td>
                    <td style="vertical-align:middle; text-align: center">{{meritAttribute.value}}</td>
                    <td style="vertical-align:middle; text-align: center">
                        <button type="button" class="btn btn-link" ng-click="deleteMeritAttribute(meritAttribute.id)">х
                        </button>
                    </td>
                </tr>
            </table>
        </div>

        <div ng-hide="meritAttachedSkills.length == 0">
            <h4 class="text-center">Пререквизиты-прикрепленные навыки</h4>
            <table class="table table-striped">
                <tr>
                    <th style="text-align: center">Навык</th>
                    <th style="text-align: center">Не меньше чем</th>
                    <th style="text-align: center"></th>
                </tr>
                <tr ng-repeat="meritAttachedSkill in meritAttachedSkills | orderBy : 'meritAttachedSkill.AttachedSkill.name'">
                    <td style="vertical-align:middle; text-align: center">{{meritAttachedSkill.AttachedSkill.name}}</td>
                    <td style="vertical-align:middle; text-align: center">{{meritAttachedSkill.value}}</td>
                    <td style="vertical-align:middle; text-align: center">
                        <button type="button" class="btn btn-link"
                                ng-click="deleteMeritAttachedSkill(meritAttachedSkill.id)">х
                        </button>
                    </td>
                </tr>
            </table>
        </div>

        <div ng-hide="meritAttributeAttachedSkills.length == 0">
            <h4 class="text-center">Пререквизиты-прикрепленные навыки+атрибуты</h4>
            <table class="table table-striped">
                <tr>
                    <th style="text-align: center">Атрибут</th>
                    <th style="text-align: center">Навык</th>
                    <th style="text-align: center">Сумма не меньше чем</th>
                    <th style="text-align: center"></th>
                </tr>
                <tr ng-repeat="meritAttributeAttachedSkill in meritAttributeAttachedSkills | orderBy : 'id'">
                    <td style="vertical-align:middle; text-align: center">{{meritAttributeAttachedSkill.Attribute.name}}
                    </td>
                    <td style="vertical-align:middle; text-align: center">
                        {{meritAttributeAttachedSkill.AttachedSkill.name}}
                    </td>
                    <td style="vertical-align:middle; text-align: center">{{meritAttributeAttachedSkill.value}}</td>
                    <td style="vertical-align:middle; text-align: center">
                        <button type="button" class="btn btn-link"
                                ng-click="deleteMeritAttributeAttachedSkill(meritAttributeAttachedSkill.id)">х
                        </button>
                    </td>
                </tr>
            </table>
        </div>

        <div ng-hide="meritTriggerSkills.length == 0">
            <h4 class="text-center">Пререквизиты-тригереные навыки</h4>
            <table class="table table-striped">
                <tr>
                    <th style="text-align: center">Навык</th>
                    <th style="text-align: center">Уровень</th>
                    <th style="text-align: center"></th>
                </tr>
                <tr ng-repeat="meritTriggerSkill in meritTriggerSkills | orderBy : 'meritTriggerSkill.TriggerSkill.name'">
                    <td style="vertical-align:middle; text-align: center">{{meritTriggerSkill.TriggerSkill.name}}</td>
                    <td style="vertical-align:middle; text-align: center">
                        <div ng-if="meritTriggerSkill.level == 0">
                            База
                        </div>
                        <div ng-if="meritTriggerSkill.level == 1">
                            Эксперт
                        </div>
                        <div ng-if="meritTriggerSkill.level == 2">
                            Мастер
                        </div>
                        <div ng-if="meritTriggerSkill.level == 3">
                            Магистр
                        </div>
                        <div ng-if="meritTriggerSkill.level == 4">
                            Гроссмейстер
                        </div>
                    </td>
                    <td style="vertical-align:middle; text-align: center">
                        <button type="button" class="btn btn-link"
                                ng-click="deleteMeritTriggerSkill(meritTriggerSkill.id)">
                            х
                        </button>
                    </td>
                </tr>
            </table>
        </div>


        <div ng-hide="meritInherents.length == 0">
            <h4 class="text-center">Пререквизиты-врожеднные особенности</h4>
            <table class="table table-striped">
                <tr>
                    <th style="text-align: center">Врожденная</th>
                    <th style="text-align: center"></th>
                    <th style="text-align: center"></th>
                    <th style="text-align: center"></th>
                </tr>
                <tr ng-repeat="meritInherent in meritInherents | orderBy : 'meritInherent.Inherent.name'">
                    <td style="vertical-align:middle; text-align: center">{{meritInherent.Inherent.name}}</td>
                    <td style="vertical-align:middle; text-align: center"
                        ng-hide="meritInherent.lessMoreEqual!=null"></td>
                    <td style="vertical-align:middle; text-align: center" ng-hide="meritInherent.lessMoreEqual!=1">НЕ
                        МЕНЕЕ
                    </td>
                    <td style="vertical-align:middle; text-align: center"
                        ng-hide="meritInherent.lessMoreEqual!=0 || meritInherent.value == null">РАВНО
                    </td>
                    <td style="vertical-align:middle; text-align: center" ng-hide="meritInherent.lessMoreEqual!=-1">НЕ
                        БОЛЕЕ
                    </td>
                    <td style="vertical-align:middle; text-align: center">{{meritInherent.value}}</td>
                    <td style="vertical-align:middle; text-align: center">
                        <button type="button" class="btn btn-link"
                                ng-click="deleteMeritInherent(meritInherent.id)">х
                        </button>
                    </td>
                </tr>
            </table>
        </div>


        <div ng-hide="meritFlaws.length == 0">
            <h4 class="text-center">Пререквизиты-недостатки</h4>
            <table class="table table-striped">
                <tr>
                    <th style="text-align: center">Недостаток</th>
                    <th style="text-align: center">Присутствует/Отсутствует</th>
                    <th style="text-align: center"></th>
                </tr>
                <tr ng-repeat="meritFlaw in meritFlaws | orderBy : 'meritFlaw.Flaw.name'">
                    <td style="vertical-align:middle; text-align: center">{{meritFlaw.Flaw.name}}</td>
                    <td style="vertical-align:middle; text-align: center" ng-show="meritFlaw.presentAbsent">Присутствует
                    </td>
                    <td style="vertical-align:middle; text-align: center" ng-show="!meritFlaw.presentAbsent">Отсутствует
                    </td>
                    <td style="vertical-align:middle; text-align: center">
                        <button type="button" class="btn btn-link"
                                ng-click="deleteMeritFlaw(meritFlaw.id)">х
                        </button>
                    </td>
                </tr>
            </table>
        </div>


        <div ng-hide="meritMerits.length == 0">
            <h4 class="text-center">Пререквизиты-достоинства</h4>
            <table class="table table-striped">
                <tr>
                    <th style="text-align: center">Достоинство</th>
                    <th style="text-align: center">Присутствует/Отсутствует</th>
                    <th style="text-align: center"></th>
                </tr>

                <tr ng-repeat="meritMerit in meritMerits | orderBy : 'meritMerit.MeritPrerequisite.name'">
                    <td style="vertical-align:middle; text-align: center">{{meritMerit.MeritPrerequisite.name}}</td>
                    <td style="vertical-align:middle; text-align: center" ng-show="meritMerit.presentAbsent">
                        Присутствует
                    </td>
                    <td style="vertical-align:middle; text-align: center" ng-show="!meritMerit.presentAbsent">
                        Отсутствует
                    </td>
                    <td style="vertical-align:middle; text-align: center">
                        <button type="button" class="btn btn-link"
                                ng-click="deleteMeritMerit(meritMerit.id)">х
                        </button>
                    </td>
                </tr>
            </table>
        </div>

        <div class="container">
            <h2>Создать пререквизит</h2>

            <form class="form-horizontal" role="form" name="addPrerequisiteForm">
                <div class="form-group">
                    <label class="control-label col-sm-2" for="type">Тип пререквизита: </label>

                    <div class="col-sm-10">
                        <select class="form-control"
                                ng-model="type" id="type" ng-options="type.id as type.name for type in types"
                                required>
                            <option style="display:none" value="">Выберите тип...</option>
                        </select>
                    </div>
                </div>

                <div class="form-group" ng-show="type == 1 || type == 3">
                    <label class="control-label col-sm-2" for="attribute_id">Атрибут: </label>

                    <div class="col-sm-10">
                        <select class="form-control"
                                ng-model="attribute_id" id="attribute_id"
                                ng-required="type == 1"
                                ng-options="attribute.id as attribute.name for attribute in attributes  | orderBy : 'name'">
                            <option style="display:none" value="">Выберите атрибут...</option>
                        </select>
                    </div>
                </div>

                <div class="form-group" ng-show="type == 2 || type == 3">
                    <label class="control-label col-sm-2" for="attached_skill_id">Навык: </label>

                    <div class="col-sm-10">
                        <select class="form-control"
                                ng-model="attached_skill_id" id="attached_skill_id"
                                ng-required="type == 2"
                                ng-options="attachedSkill.id as attachedSkill.name for attachedSkill in attachedSkills  | orderBy : 'name'">
                            <option style="display:none" value="">Выберите навык...</option>
                        </select>
                    </div>
                </div>

                <div class="form-group" ng-show="type == 1 || type == 2 || type == 3">
                    <label class="control-label col-sm-2" for="value" ng-show="type == 1 || type == 2">Не меньше
                        чем:</label>
                    <label class="control-label col-sm-2" for="value" ng-show="type == 3">Сумма не меньше чем:</label>

                    <div class="col-sm-10">
                        <input type="number" ng-model="value" class="form-control" id="value" placeholder="2"
                               ng-required="type == 1 || type == 2">
                    </div>
                </div>

                <div ng-show="type == 4">
                    <div class="form-group">
                        <label class="control-label col-sm-2" for="trigger_skill_id">Навык: </label>

                        <div class="col-sm-10">
                            <select class="form-control"
                                    ng-model="trigger_skill_id" id="trigger_skill_id"
                                    ng-required="type == 4"
                                    ng-options="triggerSkill.id as triggerSkill.name for triggerSkill in triggerSkills  | orderBy : 'name'">
                                <option style="display:none" value="">Выберите навык...</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="control-label col-sm-2" for="level">Уровень: </label>

                        <div class="col-sm-10">
                            <select class="form-control"
                                    ng-model="level" id="level" ng-options="level.id as level.name for level in levels"
                                    ng-required="type == 4">
                                <option style="display:none" value="">Выберите уровень...</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="form-group" ng-show="type == 5">
                    <label class="control-label col-sm-2" for="inherent_id">Врожденная: </label>

                    <div class="col-sm-10">
                        <select class="form-control"
                                ng-model="inherent_id" id="inherent_id"
                                ng-required="type == 5"
                                ng-change="isValuePresent()"
                                ng-options="inherent.id as inherent.name for inherent in inherents  | orderBy : 'name'">
                            <option style="display:none" value="">Выберите особенность...</option>
                        </select>
                    </div>
                </div>

                <div ng-show="isInherentValueRequired">
                    <div class="row">
                        <label class="control-label col-sm-2" for="more">Не менее: </label>

                        <div class="col-sm-2">
                            <div class="pull-left">
                                <input type="radio" ng-model="lessMoreEqual" class="form-control" id="more"
                                       ng-value="1"/>
                            </div>
                        </div>

                        <label class="control-label col-sm-2" for="equal">Равно: </label>

                        <div class="col-sm-2">
                            <div class="pull-left">
                                <input type="radio" ng-model="lessMoreEqual" class="form-control" id="equal"
                                       ng-value="0"
                                       ng-checked="true"/>
                            </div>
                        </div>

                        <label class="control-label col-sm-2" for="less">Не более: </label>

                        <div class="col-sm-2">
                            <div class="pull-left">
                                <input type="radio" ng-model="lessMoreEqual" class="form-control" id="less"
                                       ng-value="-1"/>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="control-label col-sm-2" for="inherentValue"></label>

                        <div class="col-sm-10">
                            <input type="number" ng-model="inherentValue" class="form-control" id="inherentValue"
                                   placeholder="2"
                                   ng-required="isInherentValueRequired">
                        </div>
                    </div>
                </div>

                <div class="form-group" ng-show="type == 7">
                    <label class="control-label col-sm-2" for="flaw_id">Недостаток: </label>

                    <div class="col-sm-10">
                        <select class="form-control"
                                ng-model="flaw_id" id="flaw_id"
                                ng-required="type == 7"
                                ng-options="flaw.id as flaw.name for flaw in flaws  | orderBy : 'name'">
                            <option style="display:none" value="">Выберите недостаток...</option>
                        </select>
                    </div>
                </div>

                <div class="form-group" ng-show="type == 6">
                    <label class="control-label col-sm-2" for="merit_id">Достоинство: </label>

                    <div class="col-sm-10">
                        <select class="form-control"
                                ng-model="merit_id" id="merit_id"
                                ng-required="type == 6"
                                ng-options="merit.id as merit.name for merit in merits  | orderBy : 'name'">
                            <option style="display:none" value="">Выберите достоинство...</option>
                        </select>
                    </div>
                </div>

                <div class="row" ng-show="type == 7 || type == 6">
                    <label class="control-label col-sm-2" for="present">Присутствует</label>

                    <div class="col-sm-2">
                        <div class="pull-left">
                            <input type="radio" ng-model="presentAbsent" class="form-control" id="present"
                                   ng-value="true"/>
                        </div>
                    </div>

                    <label class="control-label col-sm-2" for="absent">Отсутствует</label>

                    <div class="col-sm-2">
                        <div class="pull-left">
                            <input type="radio" ng-model="presentAbsent" class="form-control" id="absent"
                                   ng-value="false"
                                   ng-checked="true"/>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <div class="col-sm-offset-2 col-sm-10">
                        <button type="submit" class="btn btn-default" ng-click="createPrerequisite()"
                                ng-disabled="addPrerequisiteForm.$invalid">Создать
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
</body>
</html>